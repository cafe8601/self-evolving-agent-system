#!/bin/bash
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# batch-features.sh
# ì—¬ëŸ¬ ê¸°ëŠ¥ì„ ìˆœì°¨ì ìœ¼ë¡œ MDFlow ì›Œí¬í”Œë¡œìš°ë¡œ ì²˜ë¦¬
#
# ì‚¬ìš©ë²•: ./scripts/batch-features.sh
# ìˆ˜ì •:   FEATURES ë°°ì—´ì— ì›í•˜ëŠ” ê¸°ëŠ¥ ì¶”ê°€
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

set -e

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_DIR="$(dirname "$SCRIPT_DIR")"
cd "$PROJECT_DIR"

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ê¸°ëŠ¥ ëª©ë¡ ì •ì˜ (í•„ìš”ì— ë”°ë¼ ìˆ˜ì •)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FEATURES=(
    "ì‚¬ìš©ìž ì¸ì¦ ì‹œìŠ¤í…œ - JWT + ì†Œì…œ ë¡œê·¸ì¸"
    "ìƒí’ˆ ì¹´íƒˆë¡œê·¸ API - CRUD + ê²€ìƒ‰"
    "ìž¥ë°”êµ¬ë‹ˆ ì‹œìŠ¤í…œ - ì‹¤ì‹œê°„ ìž¬ê³  ê²€ì¦"
    "ì£¼ë¬¸ ì²˜ë¦¬ - WebSocket + ê²°ì œ"
    "ìž¬ê³  ë™ê¸°í™” - Optimistic Locking"
    "ì•Œë¦¼ ì‹œìŠ¤í…œ - ì´ë©”ì¼ + í‘¸ì‹œ"
    "ê´€ë¦¬ìž ëŒ€ì‹œë³´ë“œ - ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§"
)

TOTAL=${#FEATURES[@]}
CURRENT=0

echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘              ë°°ì¹˜ ê¸°ëŠ¥ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰                         â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ðŸ“‹ ì´ ${TOTAL}ê°œ ê¸°ëŠ¥ ì²˜ë¦¬ ì˜ˆì •"
echo ""

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ê° ê¸°ëŠ¥ ìˆœì°¨ ì²˜ë¦¬
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
for feature in "${FEATURES[@]}"; do
    ((CURRENT++))
    echo "=========================================="
    echo "[$CURRENT/$TOTAL] $feature"
    echo "=========================================="

    echo "$feature" | md .mdflow/evolve.claude.md

    echo ""
    echo "â³ Brain ë™ê¸°í™” ëŒ€ê¸° (5ì´ˆ)..."
    sleep 5
    echo ""
done

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ìµœì¢… ê²°ê³¼
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘                    ðŸ“š ìµœì¢… Brain ìƒíƒœ                          â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
cat .opencode/brain/project_brain.yaml

echo ""
echo "âœ… ë°°ì¹˜ íŒŒì´í”„ë¼ì¸ ì™„ë£Œ!"
echo "   - ì²˜ë¦¬ëœ ê¸°ëŠ¥: ${TOTAL}ê°œ"
echo "   - í•™ìŠµëœ íŒ¨í„´: $(grep -c 'id: LP-' .opencode/brain/project_brain.yaml 2>/dev/null || echo 0)ê°œ"
